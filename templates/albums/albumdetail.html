{% extends 'users/main.html' %} {% block content %}
{% load static %}
<main>
	<div class="modal hidden">
		<div class="bg"></div>
		<div class="modalBox">
			<div class="modal-title">
				<h2>정말로 삭제하시겠습니까?</h2>
			</div>
			<div class="modal-btn">
				<button class="closeBtn" id="btn-cancle">취소</button>
				<form action="/albumdelete/{{albuminfo.id}}" method="post">
					{% csrf_token %}<button type="submit">삭제</button>
				</form>
			</div>
		</div>
	</div>

	<div class="albumdetail">
		<div class="albumdetail__header">
			<div class="albumdetail__header-left">
				My 네 컷 앨범
			</div>
			<div class="albumdetail__header-right">
				<a href="/albumupdate/{{albuminfo.id}}"><i class="fa-solid fa-pen-to-square"></i></a>
				<button class="openBtn"><i class="fa-solid fa-trash-can"></i></button>
			</div>
		</div>

		<div class="albumdetail__date">
			<i class="fa-solid fa-angle-left"></i>
			<span>{{ albuminfo.albumdate}}</span>
			<i class="fa-solid fa-angle-right"></i>
		</div>

		<div class="albumdetail__flex-box">
			<div class="albumdetail__bg">
				<div class="swiper">
					<div class="swiper-wrapper">
						<div class="swiper-slide">
							<div class="albumdetail__img">
								{% if albuminfo.albumphoto %}
								<img src="{{ albuminfo.albumphoto.url }}" alt="">
								{% else %}
								<div>사진이 없습니다.</div>
								{% endif %}
							</div>
						</div>
						<div class="swiper-slide">
							<div class="albumdetail__video">
								{% if albuminfo.albumvideo %}
								<video autoplay loop controls> <source src="{{ albuminfo.albumvideo.url }}"></video>
								{% else %}
								<div>동영상이 없습니다.</div>
								{% endif %}
							</div>
						</div>
					</div>
					<div class="swiper-pagination"></div>
				</div>
			</div>

			<div class="albumdetail__memo">
				<img src="{% static 'image/memo.png' %}" alt="">
				<div>
					<div class="albumdetail__kind">종류 | {{albuminfo.albumtype.name}}</div>
					<div class="albumdetail__position" id="locationel">위치 | {{albuminfo.albumlocation}}</div>





					<div id="staticMap" style="width:300px;height:200px;"></div>

<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=b27755c9b07fa474fe64aeb0b2e452df&libraries=services"></script>
<script>
var a = "{{albuminfo.albumlocation}}"
a = a.replace('(',"")
a = a.replace(')',"")
console.log(a)
b = a.split(',')
if (b[2] !== undefined){ //어이가없는데 마커클릭하면 x,y좌표가 순서 반대로 들어옴
	var c = b[0]
	b[0] = b[1]
	b[1] = c
}
console.log(b[0],b[1],b[2])
console.log(Number(b[0]),Number(b[1]))

var markerPosition  = new kakao.maps.LatLng(Number(b[0]),Number(b[1])); 

var marker = {
    position: markerPosition
};


var staticMapContainer  = document.getElementById('staticMap'), // 이미지 지도를 표시할 div  
    staticMapOption = { 
        center: new kakao.maps.LatLng(Number(b[0]),Number(b[1])), // 이미지 지도의 중심좌표
        level: 6, // 이미지 지도의 확대 레벨
				marker: marker
    };

// 이미지 지도를 표시할 div와 옵션으로 이미지 지도를 생성합니다
var staticMap = new kakao.maps.StaticMap(staticMapContainer, staticMapOption);

if (b[2] !== undefined){
	kakaotext = b[2];
	let locationel = document.getElementById('locationel');
						locationel.innerHTML = '위치 | '+kakaotext
} else{
var kakaotext;
function getAddr(lat,lng){
    let geocoder = new kakao.maps.services.Geocoder();

    let coord = new kakao.maps.LatLng(lat, lng);
    let callback = function(result, status) {
        if (status === kakao.maps.services.Status.OK) {
						if (result[0].road_address !== null){
						kakaotext = '위치 | <br>지번 : '+result[0].address.address_name +'<br>도로명 : '+result[0].road_address.address_name;
						let locationel = document.getElementById('locationel');
						locationel.innerHTML = kakaotext}
						else{
							kakaotext = '위치 | <br>지번 : '+result[0].address.address_name;
						let locationel = document.getElementById('locationel');
						locationel.innerHTML = kakaotext
						}
        }
    };

    geocoder.coord2Address(coord.getLng(), coord.getLat(), callback);
}
getAddr(Number(b[0]),Number(b[1]));
}
</script>






					<div class="albumdetail__memos">메모 | {{albuminfo.albummemo}}</div>
				</div>
			</div>
		</div>
	</div>
</main>

<script>
	const open = () => {
  document.querySelector(".modal").classList.remove("hidden");
}

const close = () => {
  document.querySelector(".modal").classList.add("hidden");
}

document.querySelector(".openBtn").addEventListener("click", open);
document.querySelector(".closeBtn").addEventListener("click", close);
document.querySelector(".bg").addEventListener("click", close);
</script>
{% endblock content %}
